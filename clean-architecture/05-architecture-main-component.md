# Architecture - Main Component

> Clean Architecture 5부 26장

- 모든 시스템에는 최소 1개의 컴포넌트가 존재한다.
- 다른 컴포넌트들을 생성, 조정, 관리하는 최상위 컴포넌트를 **Main Component**라고 한다.

## 궁극적인 세부사항

- 메인 컴포넌트는 가장 낮은 수준의 정책이다.
- 시스템의 초기 진입점으로서, OS 외에 어떤 것도 메인 컴포넌트에 의존하지 않는다.
    - _iOS 앱에서는 `AppDelegate`가 진입점이 된다_
    - _앱이 `AppDelegate`에 의존해서 기능을 실행하도록 만들면 안된다._
- 메인 컴포넌트에서 모든 기반 설비를 생성한 뒤, 더 높은 수준을 담당하는 부분으로 제어권을 넘긴다.
    - Main loop 처리, 간단한 입력 명령어 해석 등은 메인 컴포넌트에서 처리
    - 실제로 처리하는 일은 다른 고수준 컴포넌트로 위임한다.
    - Command pattern 등을 사용할 수 있다.
- **의존성 주입 프레임워크를 사용해서 의존성을 주입하는 일은 메인 컴포넌트에서 이루어 져야 한다.**
    - _Swinject 같은 라이브러리 또는 프레임워크를 사용해서 의존성 관계를 만들 때, `AppDelegate`같은 main 컴포넌트에서 모두 처리한다._
- 즉, 메인 컴포넌트는 **클린 아키텍처 원의 가장 바깥에 위치하는, 가장 저수준의 모듈이다.**

## 결론

- 메인 컴포넌트를 application의 플러그인으로 생각하자.
    - 초기 설정 구성 및 외부 자원 수집
    - 이후 제어권을 고수준 정책으로 넘기는 역할
- Application의 설정 별로 **둘 이상의 메인 컴포넌트**를 만들어서 플러그인처럼 갈아 끼울 수 있다.
    - 개발용, 테스트용, 상용 설정된 메인 컴포넌트들을 여러 개 만들고, 플러그인처럼 사용할 수 있다.
    - _Xcode에서 Scheme 또는 Target을 사용해서 Stage / Production 환경을 분리하는 것과 비슷한 것 같다._
- 메인 컴포넌트를 플러그인으로 생각하고, 아키텍처 경계의 가장 바깥에 위치하면 설정 관련 문제를 쉽게 해결할 수 있다.
